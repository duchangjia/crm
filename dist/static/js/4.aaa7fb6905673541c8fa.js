webpackJsonp([4],{"7jZz":function(e,t,a){a("vu0M"),a("aTqf"),e.exports=a("M4k0")},GmUg:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("KH7x"),n=a.n(r),s=a("4YfN"),i=a.n(s),l=a("9rMa"),o={components:{},data:function(){var e=this;return{deptId:[],params:{deptIdFk:""},list:null,departmentTree:[],departmentProps:{label:"label",value:"id"},rules:{deptId:[{required:!0,message:"请选择小组",trigger:"change"}]},updateVisible:!1,updateParams:{},updateDeptId:[],updateRules:{deptIdFk:[{required:!0,message:"请选择小组",trigger:"change"}],rangeName:[{required:!0,message:"请填写班次名称",trigger:"change"}],beginTime:[{required:!0,message:"请选择开始时间",trigger:"change"}],endTime:[{required:!0,message:"请选择结束时间",trigger:"change"},{validator:function(t,a,r){var n=e.updateParams;if(n.beginTime&&n.endTime&&new Date("2018-01-01 "+n.beginTime).getTime()>=new Date("2018-01-01 "+n.endTime).getTime())return void r(new Error("开始时间必须小于结束时间"));r()},trigger:"blur"}]},groupOptions:[{id:5,label:"成考网销1组"},{id:6,label:"成考网销2组"},{id:7,label:"成考网销3组"}],testItem:{userIdFk:43,rangeId:2,deptIdFk:5,rangeName:"中班",beginTime:"09:15",endTime:"17:15"}}},computed:i()({},Object(l.d)({userInfo:function(e){return e.user.userInfo}}),{endOptions:function(){var e={start:"08:15",step:"00:15",end:"24:00"},t=this.updateParams.beginTime;if(t){var a=t.split(":"),r=n()(a,2),s=r[0],i=r[1];(i=parseInt(i)+15)>=60&&(s=(s=parseInt(s)+1)<10?"0"+s:s,i="00"),e.start=[s,i].join(":")}return e}}),watch:{deptId:function(e){e&&e.length&&(this.params.deptIdFk=e[e.length-1])}},created:function(){var e=this;this.API.qryDept({deptId:this.userInfo.deptIdFk}).then(function(t){e.departmentTree=t.result})},methods:{tableRowClassName:function(e){e.row;if(!e.rowIndex)return"tb-hd"},search:function(){var e=this;this.params.deptIdFk&&this.API.qryClsRge(this.params).then(function(t){e.list=t.result||[],e.page=t.page})},beforeSearch:function(e){var t=this;this.params.pageIndex=1,this.$refs[e].validate(function(e){e?t.search():console.log("submit error!")})},handlePageChange:function(e){this.params.pageIndex=e,this.search()},deleteItem:function(e){var t=this;this.$confirm("确定删除班次("+e.rangeName+")吗?","操作提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.API.delClsRge({rangeId:e.rangeId}).then(function(e){t.$message({type:"success",message:"删除成功!"}),t.search()})}).catch(function(){})},updateItem:function(e){this.updateVisible=!0,this.updateParams=e?{userIdFk:43,deptIdFk:e.deptIdFk||this.params.deptIdFk,rangeId:e.rangeId,rangeName:e.rangeName,beginTime:e.beginTime,endTime:e.endTime}:{userIdFk:43,deptIdFk:this.params.deptIdFk}},updateChange:function(e){console.log(e),this.updateDeptId.length&&(this.updateParams.deptIdFk=this.updateDeptId[this.updateDeptId.length-1])},submit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.updateVisible=!1;var a=t.updateParams.rangeId?"mdfClsRge":"addClsRge";t.API[a](t.updateParams).then(function(e){t.search()})})}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main-inner"},[a("bread-crumb",[a("h2",[e._v("班次管理")]),e._v(" "),a("template",{slot:"right"},[a("el-button",{attrs:{type:"default"},on:{click:function(t){e.$router.push("/working/arrange")}}},[e._v("返回排班管理")]),e._v(" "),e.$root.perm.BCGL_XZBC?a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.updateItem()}}},[e._v("新增班次")]):e._e()],1)],2),e._v(" "),a("el-form",{ref:"searchForm",staticClass:"demo-form-inline",attrs:{model:e.params,rules:e.rules,inline:!0}},[a("el-form-item",{attrs:{label:"小组",prop:"deptIdFk"}},[a("el-cascader",{staticClass:"mr20",attrs:{options:e.departmentTree,props:e.departmentProps,"show-all-levels":!1,"change-on-select":!1,"expand-trigger":"hover"},model:{value:e.deptId,callback:function(t){e.deptId=t},expression:"deptId"}})],1),e._v(" "),a("el-form-item",{staticClass:"mr20"},[a("el-button",{attrs:{type:"success"},on:{click:function(t){e.beforeSearch("searchForm")}}},[e._v("查询")])],1)],1),e._v(" "),a("data-pagination",{attrs:{"page-data":e.page},on:{change:e.handlePageChange}},[e.list?a("el-table",{staticClass:"table",attrs:{slot:"table",data:e.list,"row-class-name":e.tableRowClassName,stripe:"",border:"","header-row-class-name":"tb-hd"},slot:"table"},[a("el-table-column",{attrs:{prop:"rangeId",label:"ID",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{prop:"deptName",label:"组别",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"rangeName",label:"班次名称",width:"130"}}),e._v(" "),a("el-table-column",{attrs:{prop:"beginTime",label:"开始时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"endTime",label:"结束时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"lastModifyTime",label:"最后修改时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"userName",label:"添加人"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.$root.perm.BCGL_BJBC?a("a",{staticClass:"btn-link",attrs:{href:"javascript:void(0)"},on:{click:function(a){e.updateItem(t.row)}}},[e._v("编辑")]):e._e(),e._v(" "),e.$root.perm.BCGL_SCBC?a("a",{staticClass:"red ml10",attrs:{href:"javascript:void(0)"},on:{click:function(a){e.deleteItem(t.row)}}},[e._v("删除")]):e._e()]}}])})],1):e._e()],1),e._v(" "),a("el-dialog",{staticClass:"addAlert",attrs:{title:e.updateParams.rangeId?"编辑班次":"新增班次",visible:e.updateVisible,"close-on-click-modal":!1,width:"38%"},on:{"update:visible":function(t){e.updateVisible=t}}},[a("el-form",{ref:"updateForm",staticClass:"demo-ruleForm",attrs:{model:e.updateParams,rules:e.updateRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"小组",prop:"deptIdFk"}},[a("el-cascader",{staticClass:"mr20",attrs:{options:e.departmentTree,props:e.departmentProps,"show-all-levels":!1,"change-on-select":!1,"expand-trigger":"hover"},on:{change:e.updateChange},model:{value:e.updateDeptId,callback:function(t){e.updateDeptId=t},expression:"updateDeptId"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"班次名称",prop:"rangeName"}},[a("el-input",{staticStyle:{width:"194px"},attrs:{placeholder:"请输入班次名称"},model:{value:e.updateParams.rangeName,callback:function(t){e.$set(e.updateParams,"rangeName",t)},expression:"updateParams.rangeName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"开始时间",prop:"beginTime"}},[a("el-time-select",{staticStyle:{width:"194px"},attrs:{"picker-options":{start:"08:00",step:"00:15",end:"23:45"},placeholder:"开始时间"},model:{value:e.updateParams.beginTime,callback:function(t){e.$set(e.updateParams,"beginTime",t)},expression:"updateParams.beginTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"结束时间",prop:"endTime"}},[a("el-time-select",{staticStyle:{width:"194px"},attrs:{"picker-options":e.endOptions,placeholder:"结束时间"},model:{value:e.updateParams.endTime,callback:function(t){e.$set(e.updateParams,"endTime",t)},expression:"updateParams.endTime"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.updateVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submit("updateForm")}}},[e._v("确定")])],1)],1)],1)},staticRenderFns:[]};var u=a("Z0/y")(o,d,!1,function(e){a("t5bY")},"data-v-76ea8fcc",null);t.default=u.exports},HzJ8:function(e,t,a){e.exports={default:a("7jZz"),__esModule:!0}},KH7x:function(e,t,a){"use strict";t.__esModule=!0;var r=s(a("MGgt")),n=s(a("HzJ8"));function s(e){return e&&e.__esModule?e:{default:e}}t.default=function(){return function(e,t){if(Array.isArray(e))return e;if((0,r.default)(Object(e)))return function(e,t){var a=[],r=!0,s=!1,i=void 0;try{for(var l,o=(0,n.default)(e);!(r=(l=o.next()).done)&&(a.push(l.value),!t||a.length!==t);r=!0);}catch(e){s=!0,i=e}finally{try{!r&&o.return&&o.return()}finally{if(s)throw i}}return a}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},M4k0:function(e,t,a){var r=a("scub"),n=a("hoFe");e.exports=a("lNjp").getIterator=function(e){var t=n(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return r(t.call(e))}},MGgt:function(e,t,a){e.exports={default:a("o+vE"),__esModule:!0}},NuTe:function(e,t,a){var r=a("5cF6"),n=a("vSke")("iterator"),s=a("khS8");e.exports=a("lNjp").isIterable=function(e){var t=Object(e);return void 0!==t[n]||"@@iterator"in t||s.hasOwnProperty(r(t))}},"o+vE":function(e,t,a){a("vu0M"),a("aTqf"),e.exports=a("NuTe")},t5bY:function(e,t){}});
//# sourceMappingURL=4.aaa7fb6905673541c8fa.js.map