webpackJsonp([3],{"3Fqn":function(e,t){},"4qTS":function(e,t){},"7JTA":function(e,t){},CiU0:function(e,t){},TwN6:function(e,t){e.exports={summaryFields:[{id:"stuId",label:"学员ID"},{id:"extendType",label:"推广类型"},{id:"projectName",label:"意向项目"},{id:"intentArea",label:"机会地域"},{id:"createTime",label:"创建时间"},{id:"lastAllocTime",label:"分配时间"},{id:"lastFollowTime",label:"最后跟进时间"},{id:"lastValidFollowTime",label:"最近有效跟进"}],baseFields:[{id:"nick",label:"昵称"},{id:"name",label:"真实姓名"},{id:"studentArea",label:"学员地域"},{id:"sexName",label:"性别"},{id:"age",label:"年龄"}],detailFields:[{id:"identityName",label:"身份"},{id:"levelName",label:"水平"},{id:"classTimeName",label:"计划上课时间"},{id:"startStudyTime",label:"开始学习时间"},{id:"purpose",label:"学习用途"}],identityOptions:[{id:0,label:"未知"},{id:1,label:"在职"},{id:2,label:"学生"},{id:3,label:"自雇"},{id:4,label:"待业"},{id:5,label:"自由职业"},{id:6,label:"家庭主妇"},{id:7,label:"其他"}],occupationOptions:[{id:0,label:"未知"},{id:1,label:"相关行业"},{id:2,label:"非相关行业"},{id:3,label:"年级：初中,高中,大学"},{id:4,label:"专业"},{id:5,label:"淘宝店"},{id:6,label:"实体店"},{id:7,label:"刚毕业"},{id:8,label:"辞职、失业"}],degreeOptions:[{id:1,label:"强"},{id:2,label:"中"},{id:3,label:"弱"},{id:4,label:"无"}],genderOptions:[{id:1,label:"男"},{id:2,label:"女"}],levelOptions:[{id:0,label:"未知"},{id:1,label:"零基础"},{id:2,label:"有点基础"},{id:3,label:"基础较好"}],idCardOptions:[{id:1,label:"中国大陆身份证"},{id:2,label:"港澳台身份证"}],classTimeOptions:[{id:0,label:"未知"},{id:1,label:"晚上"},{id:2,label:"周末"},{id:3,label:"业余时间"}],extendType:[{id:0,label:"未知"},{id:1,label:"百度推广"}],addFriendOptions:[{id:2,label:"微信"},{id:3,label:"QQ"}],followOptions:[{id:0,label:"隔天联系"},{id:1,label:"约定时间联系"},{id:2,label:"稍后在联系"},{id:3,label:"今晚联系"},{id:4,label:"不需要了"}],isItConnected:[{id:0,label:"接通"},{id:1,label:"无人接听"},{id:2,label:"空号"},{id:3,label:"停机/错号"}],studentContact:[{id:0,label:"手机"},{id:1,label:"座机"},{id:2,label:"微信"},{id:3,label:"QQ"}],communicateResults:[{id:0,label:"无效沟通"},{id:1,label:"有效沟通"}],backOut:[{id:0,label:"空号错号停机"},{id:1,label:"三次无们接听"},{id:2,label:"不符合报名条件"},{id:3,label:"没有符合的产品"},{id:4,label:"已报名其他机构"},{id:5,label:"号码错误"},{id:6,label:"明确表态不需要"},{id:7,label:"谈合作"},{id:8,label:"招聘"},{id:9,label:"打过去没有咨询过"}]}},"U3/z":function(e,t){},Unm8:function(e,t){},"iH+G":function(e,t){},iui0:function(e,t){},jtNn:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=l("aA9S"),o=l.n(a),i=l("IHPB"),s=l.n(i),r=l("4YfN"),n=l.n(r),d=l("9rMa"),c=l("s0MJ"),u=l("TwN6"),m={props:["stuId"],data:function(){return{areaoptions:[],areaProps:{value:"id",label:"city",children:"cities"},showInvalid:!1,invalidData:{isConnect:"",remark:"",isValid:0,followMode:""},invalidType:[{id:0,label:"挂断"},{id:1,label:"无人接听"},{id:2,label:"空号"},{id:3,label:"停机/错号"}],EditReturnLis:u.followOptions,showCallDetail:!1,callRule:{followTimeMinute:[{required:!0,message:"请选择沟通时间"}],backPlan:[{required:!0,message:"请选择回访时间"}],nick:[{required:!0,message:"请填写昵称"}],sex:[{required:!0,message:"请选择性别"}],chanceArea:[{required:!0,message:"请选择地域"}]},invalidRule:{reason:[{required:!0,message:"请选择无效原因"}]},CallFormData:{followTimeMinute:Object(c.a)((new Date).getTime()/1e3),followMode:"",remark:"",backPlan:"",backTimeMinute:"",backRemark:"",isValid:1,isConnect:1,chanceArea:[],nick:"",sex:""},contactType:[{label:"手机",value:0},{label:"座机",value:1}],islogin:!1,cardClass:["back_tel","back_tel2","back_wexin","back_qq","back_add"],addAlert:{text:"手机",tel:"",camear:"",weixin:"",QQ:""},dialogFormVisible:!1,contactsName:["手机号码","座机","微信","QQ"],contactsList:[],rules:{tel:[{validator:function(e,t,l){Object(c.c)(t)?l():l(new Error("请输入正确的手机号"))},trigger:"blur"}],camear:[{validator:function(e,t,l){Object(c.d)(t)?l():l(new Error("请输入正确的座机"))},trigger:"blur"}],weixin:[{validator:function(e,t,l){Object(c.f)(t)?l():l(new Error("请输入正确的微信号"))},trigger:"blur"}],QQ:[{validator:function(e,t,l){Object(c.e)(t)?l():l(new Error("请输入正确的QQ"))},trigger:"blur"}]},callId:"",showTip:!1,callMessage:"通话中",btnDisabled:!0}},created:function(){this.qryStuContact(),this.isloginEvent()},watch:{$route:"qryStuContact",studentInfo:function(){var e=this.studentInfo;this.CallFormData.nick=e.nick,this.CallFormData.sex=e.sex,this.CallFormData.chanceArea=[e.provinceIdFk,e.cityIdFk],this.qryArea()}},computed:n()({},Object(d.d)({userInfo:function(e){return e.user.userInfo},deptInfo:function(e){return e.user.deptInfo},code:function(e){return e.user.code},studentInfo:function(e){return e.workbench.studentInfo}})),methods:n()({},Object(d.b)(["USER_CLEAR"]),{reLogin:function(){var e=this;this.USER_CLEAR().then(function(t){e.$router.replace("/login")})},qryArea:function(e){var t=this;this.API.qryArea({areaId:1}).then(function(e){var l=e.result.map(function(e){return{id:e.id,city:e.province||e.city,cities:[]}});t.areaoptions=l,t.studentInfo.cityIdFk&&t.handleItemChange([t.studentInfo.provinceIdFk])})},handleItemChange:function(e){if(!(e.length>1)&&e.length){var t=this.areaoptions;this.API.qryArea({areaId:e[0]}).then(function(l){t.forEach(function(t){if(t.id==e[0])return l.result[0].city?t.cities=l.result:t.cities="",!1})})}},saveInvalid:function(){var e=this;this.$refs.invalidForm.validate(function(t){if(t){var l=o()({},e.invalidData,{id:e.callId,stuIdFk:e.studentInfo.stuId});e.API.mdfStudentFollowDetail(l).then(function(t){e.$message({type:"success",message:"操作成功!"}),e.showInvalid=!1})}})},saveCallDetail:function(){var e=this;this.$refs.addCallForm.validate(function(t){if(t){var l=e.CallFormData.chanceArea,a=o()({},e.CallFormData,{id:e.callId,stuIdFk:e.studentInfo.stuId,provinceIdFk:l[0],cityIdFk:l[1]||""});e.API.mdfStudentFollowDetail(a).then(function(t){e.$message({type:"success",message:"操作成功!"}),e.showCallDetail=!1})}})},qryStuContact:function(){var e=this;this.API.qryStuContact({stuId:this.stuId}).then(function(t){e.contactsList=t.result;e.contactsList.push({name:"添加",urIndex:0,more:[]})}).catch(function(e){console.log(e.message)})},isloginEvent:function(){var e=localStorage.getItem("code");console.log(e),this.islogin=12==e||0==e},_next:function(e){e.urIndex+=1,e.urIndex>=e.more.length?e.urIndex=0:e.urIndex},_add:function(e){e.name&&(this.dialogFormVisible=!0)},playcall:function(e,t){var l=this,a=localStorage.getItem("code"),o=this;0==a||12==a?this.$confirm("确定要拨打电话："+e+"?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){l.CallFormData.followMode=t.type,l.invalidData.followMode=t.type,l.CallFormData.followTimeMinute=Object(c.a)((new Date).getTime()/1e3),l.API.hangup({userName:l.userInfo.userName,mobile:e,studentId:l.stuId}).then(function(e){l.callId=e.id,l.showTip=!0;var t=20,a=setInterval(function(){t--,o.callMessage="通话中"+t+"s",0===t&&(clearInterval(a),o.btnDisabled=!1,o.callMessage="结束通话")},1e3)})}):this.$message({type:"warning",message:"请先登录呼叫中心!"})},overCall:function(){var e=this;this.$confirm("确定要结束通话？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.API.effective({id:e.callId}).then(function(t){1==t.code?(console.log("有效通话"),e.showCallDetail=!0,e.showTip=!1):(console.log("无效通话"),e.showInvalid=!0,e.showTip=!1)})})},_hovmouseover:function(e,t){0!=e&&1!=e||this.islogin||this.$set(this.contactsList[e],"islogin",!0)},_hovmouseout:function(e,t){0!=e&&1!=e||this.islogin||this.$set(this.contactsList[e],"islogin",!1)},_addEnter:function(e){var t=this;this.$refs[e].validate(function(e){if(e){var l=t.addAlert.text;"手机"==l?t._addEnterMethods(0,t.addAlert.tel):"座机"==l?t._addEnterMethods(1,t.addAlert.camear):"微信"==l?t._addEnterMethods(2,t.addAlert.weixin):"QQ"==l&&t._addEnterMethods(3,t.addAlert.QQ)}})},_addEnterMethods:function(e,t){var l=this.contactsList[e];if(l.more.length>=3)this.$message({message:"一种联系方式，最多添加三条",type:"warning"});else{for(var a=0;a<l.more.length;a++)if(t==l.more[a])return void this.$message({message:"这个联系号码已经有了",type:"warning"});l.more.unshift(t),this.API.addStuContact({stuId:this.stuId,type:e,contact:t}).then(function(e){}).catch(function(e){console.log(e.message)}),this.dialogFormVisible=!1}}})},v={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"contacts"},[e._l(e.contactsList,function(t,a){return l("div",{key:a,staticClass:"item",class:[e.cardClass[a],{period:!t.more.length}],on:{mouseover:function(l){e._hovmouseover(a,t)},mouseout:function(l){e._hovmouseout(a,t)},click:function(l){e._add(t)}}},[[l("div",{staticClass:"warp"},[l("div",{staticClass:"left"},[l("h1",[e._v(e._s(e.contactsName[t.type]))]),e._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:t.more.length>1,expression:"item.more.length > 1 "}],staticClass:"next",on:{click:function(l){e._next(t)}}},[l("i",{staticClass:"el-icon-arrow-right"})])]),e._v(" "),2!=e.deptInfo.type||t.islogin?e._e():l("div",{directives:[{name:"show",rawName:"v-show",value:t.playCallToogl,expression:"item.playCallToogl"}],class:t.more.length?"playcall":"",on:{click:function(l){e.playcall(t.more[t.urIndex],t)}}},[l("el-button",{staticClass:"button",attrs:{size:"small",icon:"el-icon-service"}},[e._v("呼叫")])],1)]),e._v(" "),l("transition",{attrs:{name:"fade"}},[l("strong",[e._v(e._s(t.more[t.urIndex]))])])],e._v(" "),[l("div",{directives:[{name:"show",rawName:"v-show",value:2==e.deptInfo.type&&1==t.islogin,expression:"deptInfo.type == 2 && item.islogin == true"}],staticClass:"login"},[l("p",[e._v("请登录呼叫中心")]),e._v(" "),l("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.reLogin()}}},[e._v("去登录")])],1)]],2)}),e._v(" "),l("el-dialog",{staticClass:"addAlert",attrs:{title:"添加联系方式",visible:e.dialogFormVisible,width:"38%"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[l("el-form",{ref:"addAlert",staticClass:"demo-ruleForm",attrs:{model:e.addAlert,rules:e.rules,"label-width":"100px"}},[l("el-form-item",{staticStyle:{"margin-left":"-100px"}},[l("el-radio-group",{model:{value:e.addAlert.text,callback:function(t){e.$set(e.addAlert,"text",t)},expression:"addAlert.text"}},[l("el-radio-button",{attrs:{label:"手机"}}),e._v(" "),l("el-radio-button",{attrs:{label:"座机"}}),e._v(" "),l("el-radio-button",{attrs:{label:"微信"}}),e._v(" "),l("el-radio-button",{attrs:{label:"QQ"}})],1)],1),e._v(" "),"手机"==e.addAlert.text?l("el-form-item",{attrs:{label:"手机号码",prop:"tel"}},[l("el-input",{attrs:{placeholder:"请输入手机号码"},model:{value:e.addAlert.tel,callback:function(t){e.$set(e.addAlert,"tel",t)},expression:"addAlert.tel"}})],1):e._e(),e._v(" "),"座机"==e.addAlert.text?l("el-form-item",{attrs:{label:"座机号码",prop:"camear"}},[l("el-input",{attrs:{placeholder:"请输入座机号码"},model:{value:e.addAlert.camear,callback:function(t){e.$set(e.addAlert,"camear",t)},expression:"addAlert.camear"}})],1):e._e(),e._v(" "),"微信"==e.addAlert.text?l("el-form-item",{attrs:{label:"微信号",prop:"weixin"}},[l("el-input",{attrs:{placeholder:"请输入微信号"},model:{value:e.addAlert.weixin,callback:function(t){e.$set(e.addAlert,"weixin",t)},expression:"addAlert.weixin"}})],1):e._e(),e._v(" "),"QQ"==e.addAlert.text?l("el-form-item",{attrs:{label:"QQ号",prop:"QQ"}},[l("el-input",{attrs:{placeholder:"请输入QQ号"},model:{value:e.addAlert.QQ,callback:function(t){e.$set(e.addAlert,"QQ",t)},expression:"addAlert.QQ"}})],1):e._e(),e._v(" "),l("el-form-item",{staticStyle:{"margin-left":"-100px"}},[l("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")]),e._v(" "),l("el-button",{attrs:{type:"success"},on:{click:function(t){e._addEnter("addAlert")}}},[e._v("确定")])],1)],1)],1),e._v(" "),l("el-dialog",{attrs:{center:"",visible:e.showTip,width:"500px","show-close":!1},on:{"update:visible":function(t){e.showTip=t}}},[l("span",{staticClass:"title-header left",attrs:{slot:"title"},slot:"title"},[e._v("呼叫成功")]),e._v(" "),l("span",[e._v("请在通话结束后，点击“已结束通话”添加跟进信息。")]),e._v(" "),l("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{attrs:{type:"primary",disabled:e.btnDisabled},on:{click:e.overCall}},[e._v(e._s(e.callMessage))])],1)]),e._v(" "),l("el-dialog",{attrs:{center:"",visible:e.showCallDetail,width:"700px"},on:{"update:visible":function(t){e.showCallDetail=t}}},[l("span",{staticClass:"title-header left",attrs:{slot:"title"},slot:"title"},[e._v("新增学员跟进记录-基本信息")]),e._v(" "),l("el-form",{ref:"addCallForm",attrs:{model:e.CallFormData,"label-suffix":"：","label-width":"110px",rules:e.callRule}},[l("el-row",[l("el-col",{attrs:{span:12}},[l("el-form-item",{attrs:{label:"昵称",prop:"nick"}},[l("el-input",{attrs:{placeholder:"请输入昵称"},model:{value:e.CallFormData.nick,callback:function(t){e.$set(e.CallFormData,"nick",t)},expression:"CallFormData.nick"}})],1)],1),e._v(" "),l("el-col",{attrs:{span:12}},[l("el-form-item",{attrs:{label:"性别",prop:"sex"}},[l("el-radio-group",{model:{value:e.CallFormData.sex,callback:function(t){e.$set(e.CallFormData,"sex",t)},expression:"CallFormData.sex"}},[l("el-radio-button",{attrs:{label:"1"}},[e._v("男")]),e._v(" "),l("el-radio-button",{attrs:{label:"2"}},[e._v("女")])],1)],1)],1),e._v(" "),l("el-col",{attrs:{span:12}},[l("el-form-item",{attrs:{label:"地域",prop:"chanceArea"}},[l("el-cascader",{staticClass:"full-width",staticStyle:{width:"100%"},attrs:{options:e.areaoptions,clearable:"",clearable:"",props:e.areaProps,"change-on-select":!0},on:{change:e.handleItemChange},model:{value:e.CallFormData.chanceArea,callback:function(t){e.$set(e.CallFormData,"chanceArea",t)},expression:"CallFormData.chanceArea"}})],1)],1)],1),e._v(" "),l("h3",{staticClass:"title-header margin-bottom-10"},[e._v("沟通情况")]),e._v(" "),l("el-row",[l("el-col",{attrs:{span:12}},[l("el-form-item",{attrs:{label:"沟通时间",prop:"followTimeMinute"}},[l("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm",format:"yyyy-MM-dd HH:mm",disabled:"",placeholder:"选择日期时间"},model:{value:e.CallFormData.followTimeMinute,callback:function(t){e.$set(e.CallFormData,"followTimeMinute",t)},expression:"CallFormData.followTimeMinute"}})],1)],1)],1),e._v(" "),l("el-form-item",{attrs:{label:"沟通备注",prop:"remark"}},[l("el-input",{attrs:{type:"textarea"},model:{value:e.CallFormData.remark,callback:function(t){e.$set(e.CallFormData,"remark",t)},expression:"CallFormData.remark"}})],1),e._v(" "),l("h3",{staticClass:"title-header margin-bottom-10"},[e._v("回访计划")]),e._v(" "),l("el-form-item",{attrs:{label:"回访时间",prop:"backPlan"}},[l("el-col",{attrs:{span:11}},[l("el-select",{staticClass:"full-width",attrs:{placeholder:"回访时间",clearable:""},model:{value:e.CallFormData.backPlan,callback:function(t){e.$set(e.CallFormData,"backPlan",t)},expression:"CallFormData.backPlan"}},e._l(e.EditReturnLis,function(e){return l("el-option",{key:e.id,attrs:{label:e.label,value:e.id}})}))],1),e._v(" "),l("el-col",{directives:[{name:"show",rawName:"v-show",value:4!=e.CallFormData.backPlan,expression:"CallFormData.backPlan!=4"}],staticClass:"margin-left-10",attrs:{span:11}},[l("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm",format:"yyyy-MM-dd HH:mm",placeholder:"选择日期时间"},model:{value:e.CallFormData.backTimeMinute,callback:function(t){e.$set(e.CallFormData,"backTimeMinute",t)},expression:"CallFormData.backTimeMinute"}})],1)],1),e._v(" "),l("el-form-item",{attrs:{label:"备注"}},[l("el-input",{attrs:{type:"textarea"},model:{value:e.CallFormData.backRemark,callback:function(t){e.$set(e.CallFormData,"backRemark",t)},expression:"CallFormData.backRemark"}})],1)],1),e._v(" "),l("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{attrs:{type:"primary"},on:{click:e.saveCallDetail}},[e._v("保存")])],1)],1),e._v(" "),l("el-dialog",{attrs:{center:"",visible:e.showInvalid,width:"500px"},on:{"update:visible":function(t){e.showInvalid=t}}},[l("span",{staticClass:"title-header left",attrs:{slot:"title"},slot:"title"},[e._v("无效通话")]),e._v(" "),l("el-form",{ref:"invalidForm",attrs:{model:e.invalidData,"label-suffix":"：","label-width":"110px",rules:e.invalidRule}},[l("el-form-item",{attrs:{label:"无效原因",prop:"isConnect"}},[l("el-select",{staticClass:"full-width",attrs:{placeholder:"请选择",clearable:""},model:{value:e.invalidData.isConnect,callback:function(t){e.$set(e.invalidData,"isConnect",t)},expression:"invalidData.isConnect"}},e._l(e.invalidType,function(e){return l("el-option",{key:e.id,attrs:{label:e.label,value:e.id}})}))],1),e._v(" "),l("el-form-item",{attrs:{label:"备注",prop:"remark"}},[l("el-input",{attrs:{type:"textarea"},model:{value:e.invalidData.remark,callback:function(t){e.$set(e.invalidData,"remark",t)},expression:"invalidData.remark"}})],1)],1),e._v(" "),l("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{attrs:{type:"primary"},on:{click:e.saveInvalid}},[e._v("保存")])],1)],1)],2)},staticRenderFns:[]};var p=l("Z0/y")(m,v,!1,function(e){l("Unm8")},"data-v-414fd490",null).exports,f={props:["followList","addFriendList","updateList"],data:function(){return{none:"无",followMode:[{id:0,label:"手机"},{id:1,label:"座机"},{id:2,label:"微信"},{id:3,label:"QQ"}],isConnect:u.isItConnected,isValid:[{id:0,label:"无效沟通"},{id:1,label:"有效沟通"}]}},methods:{}},h={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return e.followList&&e.followList.length||e.addFriendList&&e.addFriendList.length||e.updateList&&e.updateList.length?l("el-row",{staticStyle:{padding:"0px 15px"},attrs:{gutter:20}},[e._l(e.followList,function(t,a){return l("el-col",{key:a,attrs:{span:12}},[l("el-card",{staticClass:"follow-item"},[t.followMode||0==t.followMode?l("div",{staticClass:"follow-hd clearfix",attrs:{slot:"header"},slot:"header"},[l("h3",[e._v("\n          "+e._s(e.followMode[t.followMode].label||"其他")+"\n          "),l("strong",{directives:[{name:"show",rawName:"v-show",value:1==t.source,expression:"item.source == 1"}]},[e._v("(去电生成)")])]),e._v(" "),l("p",[e._v(e._s(t.followTime))])]):e._e(),e._v(" "),l("ul",{staticClass:"follow-bd"},[l("li",{directives:[{name:"show",rawName:"v-show",value:0==t.isConnect||1==t.isConnect,expression:"item.isConnect == 0 || item.isConnect == 1"}]},[l("strong",[e._v("拨打结果：")]),e._v(" "),t.isConnect||0==t.isConnect?l("p",[e._v(e._s(e.isConnect[t.isConnect].label))]):e._e()]),e._v(" "),l("li",[l("strong",[e._v("沟通结果：")]),e._v(" "),t.isValid||0==t.isValid?l("p",[e._v(e._s(0==t.isValid?"无效跟进":"有效跟进"))]):e._e()]),e._v(" "),0!=t.isValid?l("li",[l("strong",[e._v("下次回访时间：")]),e._v(" "),l("p",[e._v(e._s(t.backTime||e.none))])]):e._e(),e._v(" "),l("li",[l("strong",[e._v("备注：")]),e._v(" "),l("p",[e._v(e._s(t.remark||e.none))])])])])],1)}),e._v(" "),e._l(e.addFriendList,function(t,a){return l("el-col",{key:a+1e3,attrs:{span:12}},[l("el-card",{staticClass:"follow-item"},[l("div",{staticClass:"follow-hd clearfix",attrs:{slot:"header"},slot:"header"},[l("h3",[e._v("我已加好友")]),e._v(" "),l("p",[e._v(e._s(t.createTime))])]),e._v(" "),l("ul",{staticClass:"follow-bd"},[l("li",[l("strong",[e._v("操作人：")]),e._v(" "),l("p",[e._v(e._s(t.operateName))])]),e._v(" "),l("li",[l("strong",[e._v("添加方式：")]),e._v(" "),t.type||0==t.type?l("p",[e._v(e._s(e.followMode[t.type].label))]):e._e()]),e._v(" "),l("li",[l("strong",[e._v("添加账号：")]),e._v(" "),l("p",[e._v(e._s(t.remark||e.none))])])])])],1)}),e._v(" "),e._l(e.updateList,function(t,a){return l("el-col",{key:a+2e3,attrs:{span:12}},[l("el-card",{staticClass:"follow-item"},[l("div",{staticClass:"follow-hd clearfix",attrs:{slot:"header"},slot:"header"},[l("h3",[e._v("编辑学员信息")]),e._v(" "),l("p",[e._v(e._s(t.createTime))])]),e._v(" "),l("ul",{staticClass:"follow-bd"},[l("li",[l("strong",[e._v("操作人：")]),e._v(" "),l("p",[e._v(e._s(t.operateName||e.none))])]),e._v(" "),t.newMobile||t.mobile?l("li",[l("strong",[e._v("修改手机号：")]),e._v(" "),l("p",[e._v(e._s(t.mobile)+" "),t.mobile&&t.newMobile?l("i",{staticClass:"el-icon-d-arrow-right"}):e._e(),e._v(" "+e._s(t.newMobile)+" ")])]):e._e(),e._v(" "),t.newWechat||t.wechat?l("li",[l("strong",[e._v("修改微信号：")]),e._v(" "),l("p",[e._v(e._s(t.wechat)+" "),t.wechat&&t.newWechat?l("i",{staticClass:"el-icon-d-arrow-right"}):e._e(),e._v(" "+e._s(t.newWechat)+" ")])]):e._e(),e._v(" "),t.newQq||t.qq?l("li",[l("strong",[e._v("修改QQ：")]),e._v(" "),l("p",[e._v(e._s(t.qq)+" "),t.qq&&t.newQq?l("i",{staticClass:"el-icon-d-arrow-right"}):e._e(),e._v(" "+e._s(t.newQq)+" ")])]):e._e(),e._v(" "),t.newPhone||t.phone?l("li",[l("strong",[e._v("修改座机号：")]),e._v(" "),l("p",[e._v(e._s(t.phone)+" "),t.phone&&t.newPhone?l("i",{staticClass:"el-icon-d-arrow-right"}):e._e(),e._v(" "+e._s(t.newPhone)+" ")])]):e._e(),e._v(" "),t.proName||t.newProName?l("li",[l("strong",[e._v("修改意向项目：")]),e._v(" "),l("p",[e._v(e._s(t.proName)+" "),t.proName&&t.newProName?l("i",{staticClass:"el-icon-d-arrow-right"}):e._e(),e._v(" "+e._s(t.newProName)+" ")])]):e._e(),e._v(" "),t.newRegionName||t.regionName?l("li",[l("strong",[e._v("修改机会地域：")]),e._v(" "),l("p",[e._v(e._s(t.regionName)+" "),t.regionName&&t.newRegionName?l("i",{staticClass:"el-icon-d-arrow-right"}):e._e(),e._v(" "+e._s(t.newRegionName)+" ")])]):e._e()])])],1)})],2):l("div",{staticClass:"follow-empty"},[e._v("暂无数据")])},staticRenderFns:[]};var _={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return e.advanceList&&e.advanceList.length?l("el-row",{staticStyle:{padding:"0px 15px"},attrs:{gutter:20}},e._l(e.advanceList,function(t,a){return l("el-col",{key:a,attrs:{span:12}},[l("el-card",{staticClass:"follow-item"},[l("div",{staticClass:"follow-hd clearfix",attrs:{slot:"header"},slot:"header"},[l("h3",[e._v(e._s(t.schoolName))]),e._v(" "),l("p",[e._v(e._s(t.createTime))])]),e._v(" "),l("ul",{staticClass:"follow-bd"},[l("li",[l("strong",[e._v("推荐项目：")]),e._v(" "),l("p",[e._v(e._s(t.proName||e.none))])]),e._v(" "),l("li",[l("strong",[e._v("推荐班型：")]),e._v(" "),l("p",[e._v(e._s(t.cname||e.none))])]),e._v(" "),l("li",[l("strong",[e._v("推荐价格：")]),e._v(" "),l("p",[e._v(e._s(t.price||e.none))])]),e._v(" "),l("li",[l("strong",[e._v("推荐原因：")]),e._v(" "),l("p",[e._v(e._s(t.remark||e.none))])])])])],1)})):l("div",{staticClass:"follow-empty"},[e._v("暂无数据")])},staticRenderFns:[]};var b={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return e.orderList&&e.orderList.length?l("el-row",{staticStyle:{padding:"0px 15px"},attrs:{gutter:20}},e._l(e.orderList,function(t,a){return l("el-col",{key:a,attrs:{span:12}},[l("el-card",{staticClass:"follow-item"},[l("div",{staticClass:"follow-hd clearfix",attrs:{slot:"header"},slot:"header"},[l("h3",[e._v("订单ID: "+e._s(t.sn))]),e._v(" "),l("p",[e._v(e._s(t.createTime))])]),e._v(" "),l("ul",{staticClass:"follow-bd order-ist"},[l("li",[l("strong",[e._v("姓名：")]),e._v(" "),l("p",[e._v(e._s(t.name||e.none))])]),e._v(" "),l("li",[l("strong",[e._v(e._s("2"==t.cardType?"港澳台证件":"身份证")+"：")]),e._v(" "),l("p",[e._v(e._s(t.cardNo||e.none))])]),e._v(" "),l("li",[l("strong",[e._v("省市：")]),e._v(" "),l("p",[e._v(e._s(t.regionName||e.none))])]),e._v(" "),l("li",[l("strong",[e._v("项目：")]),e._v(" "),l("p",[e._v(e._s(t.proName||e.none))])]),e._v(" "),l("li",[l("strong",[e._v("班型：")]),e._v(" "),l("p",[e._v(e._s(t.cname||e.none))])]),e._v(" "),l("li",[l("strong",[e._v("价格：")]),e._v(" "),l("p",[e._v(e._s(t.price||0)+"元")])]),e._v(" "),l("li",[l("strong",[e._v("优惠金额：")]),e._v(" "),l("p",[e._v(e._s(t.offsetAmount||0)+"元")])]),e._v(" "),l("li",[l("strong",[e._v("实付金额：")]),e._v(" "),l("p",[e._v(e._s(t.amount||0)+"元")])])])])],1)})):l("div",{staticClass:"follow-empty"},[e._v("暂无数据")])},staticRenderFns:[]};var g={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return e.callList&&e.callList.length?l("el-row",{staticStyle:{padding:"0px 15px"},attrs:{gutter:20}},e._l(e.callList&&e.callList.length?e.callList:[1],function(t,a){return l("el-col",{key:a,attrs:{span:12}},[l("el-card",{staticClass:"follow-item"},[l("div",{staticClass:"follow-hd clearfix",attrs:{slot:"header"},slot:"header"},[l("h3",[e._v("咨询师："+e._s(t.userName||e.none))]),e._v(" "),l("p",[e._v(e._s(t.followTime))])]),e._v(" "),l("ul",{staticClass:"follow-bd"},[l("li",[l("strong",[e._v("拨打结果：")]),e._v(" "),l("p",[e._v(e._s("接通"))])]),e._v(" "),l("li",[l("strong",[e._v("通话时长：")]),e._v(" "),l("p",[e._v(e._s(t.duration||e.none))])]),e._v(" "),l("li",[l("strong",[e._v("电话录音：")]),e._v(" "),t.url?l("p",[l("el-button",{staticClass:"mr10",attrs:{type:"text"},on:{click:e.playAudio}},[e._v("播放")]),e._v(" "),l("audio",{ref:"player",refInFor:!0,attrs:{src:t.url,controls:"controls",preload:"",hidden:""}}),e._v(" "),l("a",{staticClass:"btn-download",attrs:{href:t.url,target:"_blank"}},[e._v("下载")])],1):l("p",[e._v("无")])]),e._v(" "),l("li",[l("strong",[e._v("沟通备注：")]),e._v(" "),l("p",[e._v(e._s(t.remark||e.none))])])])])],1)})):l("div",{staticClass:"follow-empty"},[e._v("暂无数据")])},staticRenderFns:[]};var w={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return e.chatList&&e.chatList.length?l("el-row",{staticStyle:{padding:"0px 15px"},attrs:{gutter:20}},e._l(e.chatList,function(t,a){return l("el-col",{key:a,attrs:{span:12}},[l("el-card",{staticClass:"follow-item"},[l("div",{staticClass:"follow-hd clearfix",attrs:{slot:"header"},slot:"header"},[l("h3",[e._v("接待客服："+e._s(t.userName||e.none))]),e._v(" "),l("p",[e._v(e._s(t.createTime))])]),e._v(" "),l("ul",{staticClass:"follow-bd"},[l("li",[l("strong",{staticStyle:{width:"5em!important"}},[e._v("聊天记录：")]),e._v(" "),l("div",{staticStyle:{"margin-left":"5em!important"}},[l("textarea",[e._v("            "+e._s(e.$trim(t.remark)||e.none)+"\n            ")])])])])])],1)})):l("div",{staticClass:"follow-empty"},[e._v("暂无数据")])},staticRenderFns:[]};var F={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return e.allocateList&&e.allocateList.length?l("el-row",{staticStyle:{padding:"0px 15px"},attrs:{gutter:20}},e._l(e.allocateList,function(t,a){return l("el-col",{key:a,attrs:{span:12}},[l("el-card",{staticClass:"follow-item"},[l("div",{staticClass:"follow-hd clearfix",attrs:{slot:"header"},slot:"header"},[l("h3",[e._v(e._s(e.modeOptions[t.mode]))]),e._v(" "),l("p",[e._v(e._s(t.createTime))])]),e._v(" "),l("ul",{staticClass:"follow-bd"},[l("li",[l("strong",[e._v("接待客服：")]),e._v(" "),l("p",[e._v(e._s(t.inputUserName||e.none))])]),e._v(" "),l("li",[l("strong",[e._v("原归属咨询师：")]),e._v(" "),l("p",[e._v(e._s(t.beforeUserName||e.none))])]),e._v(" "),l("li",[l("strong",[e._v("分配归属咨询师：")]),e._v(" "),l("p",[e._v(e._s(t.userName||e.none))])])])])],1)})):l("div",{staticClass:"follow-empty"},[e._v("暂无数据")])},staticRenderFns:[]};var k={props:["stuId","student","projectOptions"],components:{FollowList:l("Z0/y")(f,h,!1,function(e){l("iH+G")},null,null).exports,FollowAdvance:l("Z0/y")({props:["advanceList"],data:function(){return{none:"无"}},methods:{}},_,!1,function(e){l("iui0")},"data-v-07c96e3a",null).exports,FollowOrder:l("Z0/y")({props:["orderList"],data:function(){return{none:"无"}},methods:{}},b,!1,function(e){l("CiU0")},"data-v-c5cea5a0",null).exports,FollowCall:l("Z0/y")({props:["callList"],data:function(){return{none:"无"}},watch:{},methods:{playAudio:function(e){var t=e.target;if("SPAN"===t.tagName){var l=t.parentElement.parentElement.children[1],a=function(){l.load(),t.innerText="播放"};l.removeEventListener("ended",a,!1),l.addEventListener("ended",a,!1),l.paused?(l.play(),t.innerText="暂停"):(l.pause(),t.innerText="播放")}}}},g,!1,function(e){l("zArW")},"data-v-001efaba",null).exports,FollowChat:l("Z0/y")({props:["chatList"],data:function(){return{none:"无"}},methods:{}},w,!1,function(e){l("3Fqn")},"data-v-d3b61288",null).exports,FollowAllocate:l("Z0/y")({props:["allocateList"],data:function(){return{none:"无",modeOptions:["系统分配","领取","手动分配"]}},methods:{}},F,!1,function(e){l("mFRq")},"data-v-4698dae6",null).exports},data:function(){var e=this;return{logTabName:"followList",idCardOptions:u.idCardOptions,followList:[],addFriendList:[],updateList:[],addFollowDialog:!1,schoolDialog:!1,addOrderDialog:!1,projectClassOptions:[],schoolList:[],advanceList:[],callList:[],chatList:[],orderList:[],allocateList:[],province:[],provinceProps:{value:"id",label:"city",children:"cities"},sellCity:[],wordbook:{followMode:[{id:0,label:"手机"},{id:1,label:"座机"},{id:2,label:"微信"},{id:3,label:"QQ"}],isConnect:u.isItConnected,isValid:[{id:1,label:"有效沟通"},{id:0,label:"无效沟通"}],backPlan:[{id:0,label:"隔天联系"},{id:1,label:"约定时间联系"},{id:2,label:"稍后在联系"},{id:3,label:"今晚联系"},{id:4,label:"不需要了"}],mode:["系统分配","领取","手动分配"]},followUp:{followTimeMinute:"",followMode:"",isConnect:"",isValid:"",remark:"",backPlan:"",backTimeMinute:"",backRemark:""},reservations:{advanceTimeMinute:"",schoolIdFk:"",proIdFk:"",ctIdFk:"",price:"",remark:""},orderForm:{name:"",cardType:"",cardNo:"",regionIdFk:"",proIdFk:"",ctIdFk:"",offsetAmount:"",price:""},rules:{followTimeMinute:[{required:!0,message:"请选择时间",trigger:"change"}],followMode:[{required:!0,message:"请选择联系方式",trigger:"change"}],isConnect:[{required:!0,message:"请选择拨打结果",trigger:"change"}],isValid:[{required:!0,message:"请选择沟通结果",trigger:"change"}]},reservationsRules:{advanceTimeMinute:[{required:!0,message:"请选择时间",trigger:"change"}],schoolIdFk:[{required:!0,message:"请填写报名点",trigger:"change"}],proIdFk:[{required:!0,message:"请选择项目",trigger:"change"}],ctIdFk:[{required:!0,message:"请选择班型",trigger:"change"}]},createOrderVerification:{proIdFk:[{required:!0,message:"请选择项目",trigger:"change"}],ctIdFk:[{required:!0,message:"请选择班型",trigger:"change"}],offsetAmount:[{validator:function(t,l,a){e.orderForm.offsetAmount<=0?a(new Error("优惠金额不能小于等于0")):parseInt(e.orderForm.offsetAmount)>=parseInt(e.orderForm.price)?a(new Error("优惠金额不能大于等于价格")):a()},trigger:"blur"}]}}},computed:n()({},Object(d.d)({userInfo:function(e){return e.user.userInfo}}),{offsetAmount:function(){return Math.round(100*this.orderForm.offsetAmount)/100}}),watch:{$route:"refreshRoute",followUp:{handler:function(e,t){console.log(e),e&&4==e.backPlan&&delete this.followUp.backTimeMinute},deep:!0}},created:function(){this.refreshRoute(),this.qryArea()},methods:{handleTabClick:function(e,t){var l=this;"advanceList"==this.logTabName?this.qryStudentAdvanceList():"orderList"==this.logTabName?this.qryOrderList():"callList"==this.logTabName?this.getStuCallDetailList():"chatList"==this.logTabName?this.API.getStuOnlineChatDetailList({stuId:this.stuId}).then(function(e){l.chatList=e.list}):"allocateList"==this.logTabName&&this.qryStudentAllocateList()},refreshRoute:function(){this.getStuFollowDetailList(),this.qryStudentFriendList(),this.qryStudentMdfLogList(),this.getStuCallDetailList()},getStuCallDetailList:function(){var e=this;this.API.getStuCallDetailList({stuId:this.stuId}).then(function(t){console.log(t),e.callList=t.list})},getStuFollowDetailList:function(){var e=this;this.API.getStuFollowDetailList({stuId:this.stuId}).then(function(t){e.followList=t.list}).catch(function(e){console.log(e.message)})},followUprEnter:function(e){var t=this;this.$refs[e].validate(function(e){e&&(4==t.followUp.backPlan&&(t.followUp.backTimeMinute=""),t.followUp.stuIdFk=t.stuId,t.API.addStudentFollowDetail(t.followUp).then(function(e){t.$message({message:"录入成功",type:"success"}),t.addFollowDialog=!1,t.$router.go(0)}).catch(function(e){console.log(e.message)}))})},qryStudentFriendList:function(){var e=this;this.API.qryStudentFriendList({stuId:this.stuId}).then(function(t){e.addFriendList=t.list}).catch(function(e){console.log(e.message)})},qryStudentMdfLogList:function(){var e=this;this.API.qryStudentMdfLogList({stuId:this.stuId}).then(function(t){console.log(t),e.updateList=t.list}).catch(function(e){console.log(e.message)})},reservationsEnter:function(e){var t=this;this.$refs[e].validate(function(e){e&&(t.reservations.stuIdFk=t.stuId,t.API.addStudentAdvance(t.reservations).then(function(e){t.$message({message:"创建成功",type:"success"}),t.schoolDialog=!1}).catch(function(e){console.log(e.message)}))})},qryAllSchoolInfo:function(){var e=this;this.schoolDialog=!0,!this.schoolList.length&&this.API.qryAllSchoolInfo().then(function(t){console.log(t.list),e.schoolList=t.list||[]}).catch(function(e){console.log(e.message)})},qryStudentAdvanceList:function(){var e=this;this.API.qryStudentAdvanceList({stuId:this.stuId}).then(function(t){e.advanceList=t.list}).catch(function(e){console.log(e.message)})},handleAddOrder:function(){var e=this.student;this.addOrderDialog=!0,this.orderForm.name=e.name,this.orderForm.cardType=e.cardType,this.orderForm.cardNo=e.cardNo},handleOrderSubmit:function(e){var t=this;if(1==this.orderForm.cardType){if(!Object(c.g)(this.orderForm.cardNo))return void this.$message({message:"请输入正确的身份证号",type:"warning"})}else if(2==this.orderForm.cardType&&!Object(c.b)(this.orderForm.cardNo))return void this.$message({message:"请输入正确的港澳台证件号",type:"warning"});this.$refs[e].validate(function(e){e&&(t.orderForm.stuIdFk=t.stuId,t.API.addOrder(t.orderForm).then(function(e){t.$message({message:"创建成功",type:"success"}),t.addOrderDialog=!1}).catch(function(e){console.log(e.message)}))})},qryOrderList:function(){var e=this;this.API.qryOrderList({stuId:this.stuId}).then(function(t){e.orderList=t.list}).catch(function(e){console.log(e.message)})},qryStudentAllocateList:function(){var e=this;this.API.qryStudentAllocateList({stuId:this.stuId}).then(function(t){e.allocateList=t.list}).catch(function(e){console.log(e.message)})},getProject:function(e){var t=this;this.API.qryAllClassType({proIdFk:e}).then(function(e){t.projectClassOptions=e.list})},playCallResult:function(e){this.followUp.isValid=0==e?1:0},qryArea:function(e){var t=this;this.API.qryArea({areaId:1}).then(function(e){var l=e.result.map(function(e){return{id:e.id,city:e.province||e.city,cities:[]}});t.province=l})},handleProvinceChange:function(e,t){var l=this.province;this.API.qryArea({areaId:e[0]||e}).then(function(t){l.forEach(function(l){if(l.id==e[0]||l.id==e)return t.result[0].city?l.cities=t.result:l.cities="",!1})}),this.sellCity[1]?this.orderForm.regionIdFk=this.sellCity[1]:this.orderForm.regionIdFk=this.sellCity[0]}}},y={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"follow-wp"},[l("div",{staticClass:"follow-hd"},[l("el-button",{staticClass:"mr10",attrs:{type:"primary"},on:{click:function(t){e.addFollowDialog=!0}}},[e._v("手动录入跟进")]),e._v(" "),l("el-button",{staticClass:"mr10",attrs:{type:"primary"},on:{click:e.qryAllSchoolInfo}},[e._v("创建分校预约单")]),e._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:e.handleAddOrder}},[e._v("创建订单")])],1),e._v(" "),l("div",{staticClass:"follow-bd mt20"},[l("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleTabClick},model:{value:e.logTabName,callback:function(t){e.logTabName=t},expression:"logTabName"}},[l("el-tab-pane",{attrs:{label:"跟进信息",name:"followList"}},[l("follow-list",{attrs:{"follow-list":e.followList,"add-friend-list":e.addFriendList,"update-list":e.updateList}})],1),e._v(" "),l("el-tab-pane",{attrs:{label:"分校预约单",name:"advanceList"}},[l("follow-advance",{attrs:{"advance-list":e.advanceList}})],1),e._v(" "),l("el-tab-pane",{attrs:{label:"成交订单",name:"orderList"}},[l("follow-order",{attrs:{"order-list":e.orderList}})],1),e._v(" "),l("el-tab-pane",{attrs:{label:"通话记录",name:"callList"}},[l("follow-call",{attrs:{"call-list":e.callList}})],1),e._v(" "),l("el-tab-pane",{attrs:{label:"在线聊天",name:"chatList"}},[l("follow-chat",{attrs:{"chat-list":e.chatList}})],1),e._v(" "),l("el-tab-pane",{attrs:{label:"流转日志",name:"allocateList"}},[l("follow-allocate",{attrs:{"allocate-list":e.allocateList}})],1)],1)],1),e._v(" "),l("el-dialog",{staticClass:"stick",attrs:{title:"新增跟进记录",visible:e.addFollowDialog,width:"760px"},on:{"update:visible":function(t){e.addFollowDialog=t}}},[l("el-form",{ref:"followUp",staticClass:"demo-ruleForm",attrs:{model:e.followUp,rules:e.rules,inline:!0,"label-width":"100px"}},[l("el-form-item",{attrs:{label:"联系时间",prop:"followTimeMinute"}},[l("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间","value-format":"yyyy-MM-dd HH:mm:ss","default-time":"12:00:00"},model:{value:e.followUp.followTimeMinute,callback:function(t){e.$set(e.followUp,"followTimeMinute",t)},expression:"followUp.followTimeMinute"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"联系方式",prop:"followMode"}},[l("el-select",{attrs:{placeholder:"请选择"},model:{value:e.followUp.followMode,callback:function(t){e.$set(e.followUp,"followMode",t)},expression:"followUp.followMode"}},e._l(e.wordbook.followMode,function(e){return l("el-option",{key:e.id,attrs:{label:e.label,value:e.id}})}))],1),e._v(" "),1==e.followUp.followMode||0==e.followUp.followMode?l("el-form-item",{attrs:{label:"拨打结果",prop:"isConnect"}},[l("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){e.playCallResult(t)}},model:{value:e.followUp.isConnect,callback:function(t){e.$set(e.followUp,"isConnect",t)},expression:"followUp.isConnect"}},e._l(e.wordbook.isConnect,function(e){return l("el-option",{key:e.id,attrs:{value:e.id,label:e.label}})}))],1):e._e(),e._v(" "),l("el-form-item",{attrs:{label:"沟通结果",prop:"isValid"}},[l("el-select",{attrs:{placeholder:"请选择"},model:{value:e.followUp.isValid,callback:function(t){e.$set(e.followUp,"isValid",t)},expression:"followUp.isValid"}},e._l(e.wordbook.isValid,function(t){return l("el-option",{key:t.id,attrs:{disabled:1==e.followUp.followMode||0==e.followUp.followMode,value:t.id,label:t.label}})}))],1),e._v(" "),l("br"),e._v(" "),l("el-form-item",{attrs:{label:"沟通备注"}},[l("el-input",{staticStyle:{width:"270%"},attrs:{type:"textarea"},model:{value:e.followUp.remark,callback:function(t){e.$set(e.followUp,"remark",t)},expression:"followUp.remark"}})],1),e._v(" "),l("div",{staticClass:"g-title"},[l("h2",[e._v("回访计划")])]),e._v(" "),l("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"回访时间"}},[l("el-select",{attrs:{placeholder:"请选择"},model:{value:e.followUp.backPlan,callback:function(t){e.$set(e.followUp,"backPlan",t)},expression:"followUp.backPlan"}},e._l(e.wordbook.backPlan,function(e){return l("el-option",{key:e.id,attrs:{value:e.id,label:e.label}})})),e._v(" "),4!==e.followUp.backPlan?l("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间","value-format":"yyyy-MM-dd HH:mm:ss","default-time":"12:00:00"},model:{value:e.followUp.backTimeMinute,callback:function(t){e.$set(e.followUp,"backTimeMinute",t)},expression:"followUp.backTimeMinute"}}):e._e()],1),e._v(" "),l("br"),e._v(" "),l("el-form-item",{attrs:{label:"备注"}},[l("el-input",{staticStyle:{width:"270%"},attrs:{type:"textarea"},model:{value:e.followUp.backRemark,callback:function(t){e.$set(e.followUp,"backRemark",t)},expression:"followUp.backRemark"}})],1),e._v(" "),l("el-form-item",{staticStyle:{width:"100%","text-align":"center"}},[l("el-button",{on:{click:function(t){e.addFollowDialog=!1}}},[e._v("取消")]),e._v(" "),l("el-button",{attrs:{type:"success"},on:{click:function(t){e.followUprEnter("followUp")}}},[e._v("确定")])],1)],1)],1),e._v(" "),l("el-dialog",{staticClass:"stick",attrs:{title:"创建分校预约单",visible:e.schoolDialog,width:"760px"},on:{"update:visible":function(t){e.schoolDialog=t}}},[l("el-form",{ref:"reservations",staticClass:"demo-ruleForm",attrs:{model:e.reservations,rules:e.reservationsRules,inline:!0,"label-width":"100px"}},[l("el-form-item",{attrs:{label:"预约时间",prop:"advanceTimeMinute"}},[l("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间","value-format":"yyyy-MM-dd HH:mm:ss","default-time":"12:00:00"},model:{value:e.reservations.advanceTimeMinute,callback:function(t){e.$set(e.reservations,"advanceTimeMinute",t)},expression:"reservations.advanceTimeMinute"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"预约校区",prop:"schoolIdFk"}},[l("el-select",{attrs:{placeholder:"请选择分校"},model:{value:e.reservations.schoolIdFk,callback:function(t){e.$set(e.reservations,"schoolIdFk",t)},expression:"reservations.schoolIdFk"}},e._l(e.schoolList,function(e){return l("el-option",{key:e.id,attrs:{value:e.id,label:e.name}})}))],1),e._v(" "),l("el-form-item",{attrs:{label:"推荐项目",prop:"proIdFk"}},[l("el-select",{attrs:{placeholder:"请选择项目"},on:{change:function(t){e.getProject(t)}},model:{value:e.reservations.proIdFk,callback:function(t){e.$set(e.reservations,"proIdFk",t)},expression:"reservations.proIdFk"}},e._l(e.projectOptions,function(e){return l("el-option",{key:e.proId,attrs:{value:e.proId,label:e.proName}})}))],1),e._v(" "),l("el-form-item",{attrs:{label:"推荐班型",prop:"ctIdFk"}},[l("el-select",{attrs:{placeholder:"请选择班型"},model:{value:e.reservations.ctIdFk,callback:function(t){e.$set(e.reservations,"ctIdFk",t)},expression:"reservations.ctIdFk"}},e._l(e.projectClassOptions,function(e){return l("el-option",{key:e.ctId,attrs:{value:e.ctId,label:e.cname}})}))],1),e._v(" "),l("el-form-item",{attrs:{label:"推荐价格"}},[l("el-input",{model:{value:e.reservations.price,callback:function(t){e.$set(e.reservations,"price",t)},expression:"reservations.price"}})],1),e._v(" "),l("br"),e._v(" "),l("el-form-item",{attrs:{label:"推荐原因"}},[l("el-input",{attrs:{type:"textarea"},model:{value:e.reservations.remark,callback:function(t){e.$set(e.reservations,"remark",t)},expression:"reservations.remark"}})],1),e._v(" "),l("el-form-item",{staticStyle:{width:"100%","text-align":"center"}},[l("el-button",{on:{click:function(t){e.schoolDialog=!1}}},[e._v("取消")]),e._v(" "),l("el-button",{attrs:{type:"success"},on:{click:function(t){e.reservationsEnter("reservations")}}},[e._v("确定")])],1)],1)],1),e._v(" "),l("el-dialog",{staticClass:"stick",attrs:{title:"创建订单",visible:e.addOrderDialog,width:"760px"},on:{"update:visible":function(t){e.addOrderDialog=t}}},[l("el-form",{ref:"orderForm",staticClass:"demo-ruleForm",attrs:{model:e.orderForm,rules:e.createOrderVerification,"label-width":"100px"}},[l("el-form-item",{attrs:{label:"姓名：",prop:"name"}},[l("el-input",{model:{value:e.orderForm.name,callback:function(t){e.$set(e.orderForm,"name",t)},expression:"orderForm.name"}})],1),e._v(" "),l("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"身份证："}},[l("el-select",{staticStyle:{width:"35%"},attrs:{placeholder:"请选择："},model:{value:e.orderForm.cardType,callback:function(t){e.$set(e.orderForm,"cardType",t)},expression:"orderForm.cardType"}},e._l(e.idCardOptions,function(e,t){return l("el-option",{key:t,attrs:{label:e.label,value:e.id}})})),e._v(" "),l("el-input",{staticStyle:{width:"45%"},model:{value:e.orderForm.cardNo,callback:function(t){e.$set(e.orderForm,"cardNo",t)},expression:"orderForm.cardNo"}})],1),e._v(" "),l("div",[l("el-form-item",{attrs:{label:"售卖省市："}},[l("el-cascader",{attrs:{options:e.province,"change-on-select":!0,clearable:"",props:e.provinceProps},on:{change:function(t){e.handleProvinceChange(t)}},model:{value:e.sellCity,callback:function(t){e.sellCity=t},expression:"sellCity"}})],1)],1),e._v(" "),l("el-form-item",{attrs:{label:"选择项目：",prop:"proIdFk"}},[l("el-select",{attrs:{placeholder:"请选择项目"},on:{change:function(t){e.getProject(t)}},model:{value:e.orderForm.proIdFk,callback:function(t){e.$set(e.orderForm,"proIdFk",t)},expression:"orderForm.proIdFk"}},e._l(e.projectOptions,function(e){return l("el-option",{key:e.proId,attrs:{value:e.proId,label:e.proName}})}))],1),e._v(" "),l("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"选择班型：",prop:"ctIdFk"}},[l("el-select",{attrs:{placeholder:"请选择班型"},model:{value:e.orderForm.ctIdFk,callback:function(t){e.$set(e.orderForm,"ctIdFk",t)},expression:"orderForm.ctIdFk"}},e._l(e.projectClassOptions,function(e){return l("el-option",{key:e.ctId,attrs:{value:e.ctId,label:e.cname}})}))],1),e._v(" "),l("el-form-item",{attrs:{label:"价格：",prop:"price"}},[l("el-input",{attrs:{placeholder:"请输入价格"},model:{value:e.orderForm.price,callback:function(t){e.$set(e.orderForm,"price",t)},expression:"orderForm.price"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"优惠金额：",prop:"offsetAmount"}},[l("el-input",{model:{value:e.orderForm.offsetAmount,callback:function(t){e.$set(e.orderForm,"offsetAmount",t)},expression:"orderForm.offsetAmount"}})],1),e._v(" "),l("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"实付金额："}},[l("span",[e._v(e._s(e.orderForm.price-e.offsetAmount)+"元")])]),e._v(" "),l("div",{staticClass:"tac"},[l("el-button",{on:{click:function(t){e.addOrderDialog=!1}}},[e._v("取消")]),e._v(" "),l("el-button",{attrs:{type:"success"},on:{click:function(t){e.handleOrderSubmit("orderForm")}}},[e._v("确定")])],1),e._v(">\n    ")],1)],1)],1)},staticRenderFns:[]};var C={props:["stuCardList"],components:{StudentContact:p,StudentFollow:l("Z0/y")(k,y,!1,function(e){l("7JTA"),l("U3/z")},"data-v-6fd36b4d",null).exports},data:function(){return{stuId:this.$route.params.id,none:"无",summaryFields:u.summaryFields,baseFields:u.baseFields,detailFields:u.detailFields,intention:4,intentionVal:"强",student:null,giveUpDialog:!1,giveUpForm:{},addFriendDialog:!1,addFriendForm:{remark:"",type:"",label:""},accountOptions:[],followData:{},followForm:{},followRules:{backPlan:[{required:!0,message:"请选择回访时间",trigger:"change"}]},projectOptions:[],dialogFormVisible:!1,dialogFormVisibleFriend:!1,followDialog:!1,stutentInfo:{},stuCardInfo:{},Friendlist:[],showBackPlanId:0,province:[],provinceProps:{value:"id",label:"city",children:"cities"},intentProvinceIdFk:[],intentCityIdFk:[],provinceIdFk:[],cityIdFk:[],giveUpAlert:{region:"",Friendregion:"",way:""},EditReturn:{backPlan:"",backTime:"",backRemark:"",id:-1},EditReturnList:[{id:0,label:"约定时间联系"},{id:1,label:"稍后再联系"},{id:2,label:"今晚联系"},{id:3,label:"隔天联系"},{id:4,label:"不需要了"}],values:[{id:0,label:"空号错号停机"},{id:1,label:"三次无们接听"},{id:2,label:"不符合报名条件"},{id:3,label:"没有符合的产品"},{id:4,label:"已报名其他机构"},{id:5,label:"号码错误"},{id:6,label:"明确表态不需要"},{id:7,label:"谈合作"},{id:8,label:"招聘"},{id:9,label:"打过去没有咨询过"}],rules:{region:[{required:!0,message:"请选择退回原因",trigger:"change"}],Friendregion:[{required:!0,message:"请选择账号",trigger:"change"}],way:[{required:!0,message:"请选择",trigger:"change"}],returnOff:[{required:!0,message:"请选择回访时间",trigger:"change"}]},identityOptions:u.identityOptions,degreeList:u.degreeList,genderOptions:u.genderOptions,levelOptions:u.levelOptions,classTimeOptions:u.classTimeOptions,idCardOptions:u.idCardOptions,followOptions:u.followOptions,addFriendOptions:u.addFriendOptions}},computed:n()({},Object(d.d)({userInfo:function(e){return e.user.userInfo}}),{studentNew:function(){var e=this.student;if(!e)return{};var t=(e.intentProvinceName||"")+(e.intentCityName?" - "+e.intentCityName:""),l=(e.provinceName||"")+(e.cityName?" - "+e.cityName:"");return{intentSubjectName:e.intentSubject,intentArea:t,studentArea:l,sexName:parseInt(e.sex)>-1?this.genderOptions[e.sex-1].label:"未知",identityName:parseInt(e.identity)>-1?this.identityOptions[e.identity].label:"未知",levelName:parseInt(e.level)>=-1?this.levelOptions[e.level].label:"未知",classTimeName:parseInt(e.classTime)>-1?this.classTimeOptions[e.classTime].label:"未知"}},studentDegree:function(){var e=this.student.degree;return{value:parseInt(e)>-1?[0,5,4,2,.5][e]:this.none,label:parseInt(e)>-1?["未知","强","中","弱","无"][e]:this.none}}}),watch:{$route:"getrouterQuery"},created:function(){this.getrouterQuery(),this.qryAllProject()},methods:n()({},Object(d.c)(["STUDENT_INFO"]),{getrouterQuery:function(){this.stuId=this.$route.params.id,this.getStuBaseInfo(),this.getStuFollowDetail()},intentSubjectSum:function(){for(var e=0;e<this.projectOptions.length;e++)if(this.student.intentSubject==this.projectOptions[e].proId)return this.projectOptions[e].proName},showBackPlan:function(e){this.showBackPlanId=e},getStuBaseInfo:function(){var e=this;console.log(this.stuId),this.API.getStuBaseInfo({stuId:this.stuId}).then(function(t){e.student=t.result[0].stuInfo,e.STUDENT_INFO(e.student)}).catch(function(e){console.log(e.message)})},getStuFollowDetail:function(){var e=this;this.API.getStuFollowDetail({stuId:this.stuId,userId:this.userInfo.userId}).then(function(t){console.log(t.result),e.followData=t.result||{}}).catch(function(e){console.log(e.message)})},handleUpdateFollow:function(){this.followDialog=!0;var e=this.followData;this.followForm={id:e.id,backPlan:e.backPlan,backTime:e.backTime,backRemark:e.backRemark}},giveUpSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("submit error!"),!1;t.giveUpDialog=!1,t.API.delBelongTo({stuId:t.stuId,reason:t.giveUpForm.reason}).then(function(e){}).catch(function(e){console.log(e.message)})})},handleFollowSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("submit error!"),!1;t.followDialog=!1,4==t.followForm.backPlan&&delete t.followForm.backTime,t.API.mdfStuFollowDetail(t.followForm).then(function(e){t.followData=t.followForm}).catch(function(e){console.log(e.message)})})},qryAllProject:function(){var e=this;this.API.qryAllProject().then(function(t){e.projectOptions=t.list}).catch(function(e){console.log(e.message)})},addFriend:function(){0==this.student.friend?this.$message({message:"你已经添加该学员为好友了！",type:"warning"}):this.addFriendDialog=!0},addFriendTab:function(){var e=this;this.API.qryStuContact({stuId:this.stuId}).then(function(t){console.log(e.addFriendForm.type),"微信"==e.addFriendForm.label?(e.addFriendForm.type=2,e.accountOptions=[].concat(s()(t.result[e.addFriendForm.type].more),s()(t.result[0].more))):(e.addFriendForm.type=3,e.accountOptions=t.result[e.addFriendForm.type].more),e.addFriendForm.remark=""}).catch(function(e){console.log(e.message)})},addFriendSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("sumbit error!"),!1;t.addFriendDialog=!1,t.API.addFriend(o()(t.addFriendForm,{userIdFk:t.userInfo.userId,stuIdFk:t.stuId})).then(function(e){t.$message({message:"添加成功",type:"success"})}).catch(function(e){console.log(e.message)})})}})},I={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return e.student?l("div",{},[l("student-contact",{attrs:{"stu-id":e.stuId}}),e._v(" "),l("div",{staticClass:"student-info"},[l("div",{staticClass:"item"},[l("div",{staticClass:"student-hd"},[e._m(0),e._v(" "),l("div",{staticClass:"progress"},[l("span",[e._v("学员意向度：")]),e._v(" "),l("el-rate",{staticClass:"xinxin",attrs:{"score-template":e.studentDegree.label,disabled:"","show-score":"","text-color":"#40b3ff"},model:{value:e.studentDegree.value,callback:function(t){e.$set(e.studentDegree,"value",t)},expression:"studentDegree.value"}})],1),e._v(" "),l("div",{staticClass:"btn-right"},[l("el-button",{staticClass:"btn",attrs:{type:"text",size:"small"},on:{click:function(t){e.giveUpDialog=!0}}},[e._v("放弃归属")]),e._v(" "),l("el-button",{staticClass:"btn",attrs:{type:"text",size:"small"},on:{click:e.addFriend}},[e._v("我已加为好友")]),e._v(" "),l("el-button",{staticClass:"btn",attrs:{type:"text",size:"small"},on:{click:function(t){e.$router.push("/work-center/student-update/"+e.stuId)}}},[e._v("编辑学员信息")])],1)]),e._v(" "),l("ul",{staticClass:"list"},e._l(e.summaryFields,function(t,a){return l("li",[l("strong",[e._v(e._s(t.label)+"：")]),e._v(" "),l("span",[e._v(e._s(e.student[t.id]||e.studentNew[t.id]||e.none))])])}))]),e._v(" "),l("div",{staticClass:"item"},[e._m(1),e._v(" "),l("ul",{staticClass:"list"},[e._l(e.baseFields,function(t,a){return l("li",[l("strong",[e._v(e._s(t.label)+"：")]),e._v(" "),l("span",[e._v(e._s(e.student[t.id]||e.studentNew[t.id]||e.none))])])}),e._v(" "),l("li",[l("strong",[e._v(e._s(e.student.cardType&&1!=e.student.cardType?"港澳台证件：":"身份证："))]),e._v(" "),l("span",[e._v(e._s(e.student.cardNo||"无"))])])],2)]),e._v(" "),l("div",{staticClass:"item"},[e._m(2),e._v(" "),l("ul",{staticClass:"list"},e._l(e.detailFields,function(t,a){return l("li",{class:{"col-2":"purpose"==t.id}},[l("strong",[e._v(e._s(t.label)+"：")]),e._v(" "),l("span",[e._v(e._s(e.student[t.id]||e.studentNew[t.id]||e.none))])])}))]),e._v(" "),l("div",{staticClass:"item"},[l("div",{staticClass:"student-hd"},[e._m(3),e._v(" "),e.followData.id?l("el-button",{staticClass:"btn-plan fr mr20",attrs:{type:"primary",size:"small"},on:{click:e.handleUpdateFollow}},[e._v("修改计划")]):e._e()],1),e._v(" "),e.followData?l("div",{staticClass:"plan"},[l("ul",{staticClass:"list"},[l("li",{staticClass:"col-3"},[l("strong",[e._v("下次回访时间：")]),e._v(" "),parseInt(e.followData.backPlan)>-1?l("span",[e._v("\n              "+e._s(e.followOptions[e.followData.backPlan].label)+" "+e._s(e.followData.backTime||"")+"\n            ")]):l("span",[e._v(e._s(e.none))])]),e._v(" "),l("li",{staticClass:"col-3"},[l("strong",[e._v("回访备注：")]),e._v(" "),l("span",{staticStyle:{width:"calc(100% - 150px)"}},[e._v(e._s(e.followData.backRemark||e.none))])])])]):e._e()]),e._v(" "),l("el-dialog",{staticClass:"giveup-dialog",attrs:{title:"放弃归属",visible:e.giveUpDialog,width:"600px"},on:{"update:visible":function(t){e.giveUpDialog=t}}},[l("el-form",{ref:"giveUpForm",staticClass:"demo-ruleForm",attrs:{model:e.giveUpForm,rules:e.rules,"label-width":"100px"}},[l("p",{staticStyle:{margin:"0 0 20px 34px"}},[e._v("放弃归属后，其他咨询师可在公海库中领取该学员，确认进行此操作？")]),e._v(" "),l("el-form-item",{attrs:{label:"退回原因",prop:"reason"}},[l("el-select",{staticStyle:{width:"360px"},attrs:{placeholder:"请选择退回原因"},model:{value:e.giveUpForm.reason,callback:function(t){e.$set(e.giveUpForm,"reason",t)},expression:"giveUpForm.reason"}},e._l(e.values,function(e){return l("el-option",{key:e.id,attrs:{value:e.id,label:e.label}})}))],1),e._v(" "),l("div",{staticClass:"tac"},[l("el-button",{on:{click:function(t){e.giveUpDialog=!1}}},[e._v("取消")]),e._v(" "),l("el-button",{attrs:{type:"success"},on:{click:function(t){e.giveUpSubmit("giveUpForm")}}},[e._v("确定")])],1)],1)],1),e._v(" "),l("el-dialog",{staticClass:"giveUpAlert",attrs:{title:"你已经添加该学员为好友？",visible:e.addFriendDialog,width:"600"},on:{"update:visible":function(t){e.addFriendDialog=t}}},[l("el-form",{ref:"addFriendForm",staticClass:"demo-ruleForm",attrs:{model:e.addFriendForm,rules:e.rules,"label-width":"100px"}},[l("el-form-item",{staticStyle:{"text-align":"left"},attrs:{label:"添加方式",prop:"type"}},[l("el-radio-group",{on:{change:e.addFriendTab},model:{value:e.addFriendForm.label,callback:function(t){e.$set(e.addFriendForm,"label",t)},expression:"addFriendForm.label"}},e._l(e.addFriendOptions,function(e,t){return l("el-radio-button",{key:t,attrs:{label:e.label,value:e.id}})}))],1),e._v(" "),l("el-form-item",{attrs:{label:"添加账号",prop:"remark"}},[l("el-select",{attrs:{placeholder:"请选择"},model:{value:e.addFriendForm.remark,callback:function(t){e.$set(e.addFriendForm,"remark",t)},expression:"addFriendForm.remark"}},e._l(e.accountOptions,function(e,t){return l("el-option",{key:t,attrs:{value:e,label:e}})}))],1),e._v(" "),l("div",{staticClass:"tac"},[l("el-button",{on:{click:function(t){e.addFriendDialog=!1}}},[e._v("取消")]),e._v(" "),l("el-button",{attrs:{type:"success"},on:{click:function(t){e.addFriendSubmit("addFriendForm")}}},[e._v("确定")])],1)],1)],1),e._v(" "),e.followData.id?l("el-dialog",{attrs:{title:"修改回访计划",visible:e.followDialog,width:"600px"},on:{"update:visible":function(t){e.followDialog=t}}},[l("el-form",{ref:"followForm",staticClass:"demo-ruleForm",attrs:{model:e.followForm,rules:e.followRules,"label-width":"100px"}},[l("el-form-item",{attrs:{label:"回访时间：",prop:"backPlan"}},[l("el-select",{attrs:{placeholder:"请选择"},model:{value:e.followForm.backPlan,callback:function(t){e.$set(e.followForm,"backPlan",t)},expression:"followForm.backPlan"}},e._l(e.followOptions,function(e,t){return l("el-option",{key:t,attrs:{label:e.label,value:e.id}})})),e._v(" "),4!=e.followForm.backPlan?l("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm",placeholder:"选择日期"},model:{value:e.followForm.backTime,callback:function(t){e.$set(e.followForm,"backTime",t)},expression:"followForm.backTime"}}):e._e()],1),e._v(" "),l("el-form-item",{attrs:{label:"回访备注："}},[l("el-input",{staticStyle:{width:"420px"},attrs:{type:"textarea"},model:{value:e.followForm.backRemark,callback:function(t){e.$set(e.followForm,"backRemark",t)},expression:"followForm.backRemark"}})],1),e._v(" "),l("el-form-item",{staticClass:"btn-right"},[l("el-button",{on:{click:function(t){e.followDialog=!1}}},[e._v("取消")]),e._v(" "),l("el-button",{attrs:{type:"success"},on:{click:function(t){e.handleFollowSubmit("followForm")}}},[e._v("确定")])],1)],1)],1):e._e()],1),e._v(" "),l("student-follow",{attrs:{"stu-id":e.stuId,student:e.student,"project-options":e.projectOptions}})],1):e._e()},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h4",{staticClass:"student-tit"},[t("span"),this._v(" "),t("h3",[this._v("学员概要")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"student-hd"},[t("h4",{staticClass:"student-tit"},[t("span"),this._v(" "),t("h3",[this._v("基本信息")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"student-hd"},[t("h4",{staticClass:"student-tit"},[t("span"),this._v(" "),t("h3",[this._v("详细信息")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h4",{staticClass:"student-tit"},[t("span"),this._v(" "),t("h3",[this._v("回访计划")])])}]};var x=l("Z0/y")(C,I,!1,function(e){l("4qTS")},"data-v-9e735a16",null);t.default=x.exports},mFRq:function(e,t){},zArW:function(e,t){}});
//# sourceMappingURL=3.647d36b4548acddca02e.js.map